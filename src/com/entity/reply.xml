<?xml version="1.0" encoding="UTF-8"?>  
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 配置Mabatis映射文件 -->
<mapper namespace="com.dao.ReplyDAO">
	<resultMap type="reply" id="replyMap">
		<id property="replyid" column="replyid" />
		<result property="usersid" column="usersid" />
		<result property="articleid" column="articleid" />
		<result property="username" column="username" />
		<result property="reply" column="reply" />
		<result property="addtime" column="addtime" />
		<result property="title" column="title" />
	</resultMap>
	
	<!-- 插入语句 DAO通过id调用此配置 -->
	<insert id="insertReply" parameterType="reply">
		insert into reply(replyid , articleid , usersid , username , reply , addtime ) values (#{replyid} , #{articleid} ,
		#{usersid} , #{username} , #{reply} , #{addtime})
	</insert>
	
	<!-- 更新语句 DAO通过id调用此配置 -->
	<update id="updateReply" parameterType="reply">
		update reply set articleid=#{articleid} , usersid=#{usersid} ,
		username=#{username} , reply=#{reply} , addtime=#{addtime} , where	replyid=#{replyid}
	</update>
	
	<!-- 按主键删除 DAO通过id调用此配置 -->
	<delete id="deleteReply" parameterType="String">
		delete from reply where replyid = #{replyid}
	</delete>
	
	<!-- 查询全部信息 DAO通过id调用此配置 -->
	<select id="getAllOrders" resultMap="replyMap">
		select a.*, b.username , c.title from reply a , users b , article c where 1=1 and a.usersid =b.usersid and
		a.articleid = c.articleid reply by replyid desc
	</select>
	
	<!-- 按主键查询 DAO通过id调用此配置 -->
	<select id="getReplyById" parameterType="String" resultMap="replyMap">
		select a.*, b.username , c.title from reply a , users b , article c where 1=1 and a.usersid =b.usersid and
		a.articleid = c.articleid and replyid=#{replyid}  reply by replyid desc
	</select>
	
	<!-- 按条件精确查询 DAO通过id调用此配置 -->
	<select id="getReplyByCond" parameterType="reply" resultMap="replyMap">
		select a.*, b.username , c.title from reply a , users b , article c where 1=1 and a.usersid =b.usersid and
		a.articleid = c.articleid
		<if test="usersid != null and '' != usersid">
			and a.usersid = #{usersid}
		</if>
		<if test="articleid != null and '' != articleid">
			and a.articleid = #{articleid}
		</if>
		<if test="username != null and '' != username">
			and a.username = #{username}
		</if>
		<if test="reply != null and '' != reply">
			and a.reply = #{reply}
		</if>
		<if test="addtime != null and '' != addtime">
			and a.addtime = #{addtime}
		</if>
		<if test="title != null and '' != title">
			and a.title = #{title}
		</if>
	</select>
	
	<!-- 按条件模糊查询 DAO通过id调用此配置 -->
	<select id="getReplyByLike" parameterType="reply" resultMap="replyMap">
		select a.*, b.username , c.title from reply a , users b , article c where 1=1 and a.usersid =b.usersid and
		a.articleid = c.articleid
		<if test="usersid != null and '' != usersid">
			and a.usersid like CONCAT('%', CONCAT(#{usersid}, '%'))
		</if>
		<if test="articleid != null and '' != articleid">
			and a.articleid like CONCAT('%', CONCAT(#{articleid}, '%'))
		</if>
		<if test="username != null and '' != username">
			and a.username like CONCAT('%', CONCAT(#{username}, '%'))
		</if>
		<if test="reply != null and '' != reply">
			and a.reply like CONCAT('%', CONCAT(#{reply}, '%'))
		</if>
		<if test="addtime != null and '' != addtime">
			and a.addtime like CONCAT('%', CONCAT(#{addtime}, '%'))
		</if>
		<if test="title != null and '' != title">
			and a.title like CONCAT('%', CONCAT(#{title}, '%'))
		</if>
	</select>
</mapper>


